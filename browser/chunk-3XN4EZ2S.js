import{a as tn,b as Ie,c as ue,d as Ne,h as yt,i as _t}from"./chunk-YXXGOJWJ.js";import{b as xe,h as gt}from"./chunk-MX3DAUQE.js";import{$ as w,$a as g,Ba as Ae,Bb as pt,Ca as f,Cb as N,Db as b,Ea as W,Eb as S,Ha as D,Ia as we,Ja as L,Ka as nt,La as q,M as Me,Ma as it,N as T,O as Ve,Oa as rt,Q as P,Ra as Se,Sa as I,T as H,Ta as z,Ua as ot,Va as j,Wa as st,Ya as oe,Z as R,Za as se,_ as A,_a as m,a as y,ab as M,b as v,bb as ae,ca as et,cb as V,d as en,db as Fe,ha as k,hb as at,i as Ke,ib as lt,jb as ut,ka as tt,kb as J,l as Qe,la as Ee,lb as ct,ma as Te,na as c,nb as C,ob as le,q as Ze,qb as dt,rb as ht,sb as ft,tb as Oe,va as re,w as Xe,xa as p,zb as mt}from"./chunk-LWG2RFLJ.js";var F={json:"json",typeorm:"typeorm",prisma:"prisma"},Wn=Object.values(F),Ct={json:{id:"json",label:"JSON",description:"Json representation of the database schema",icon:"curly-braces",classNames:"bg-json"},typeorm:{id:"typeorm",label:"TypeORM",description:"TypeORM entities code",icon:"typeorm",classNames:"bg-typeorm"},prisma:{id:"prisma",label:"Prisma",description:"Prisma schema code",icon:"prisma",classNames:"bg-prisma"}};function vt(i){return JSON.stringify(i,null,2)}var Pe={">":{from:"many",to:"one"},"<":{from:"one",to:"many"},"<>":{from:"many",to:"many"},"-":{from:"one",to:"one"}};var Y={PrimaryKey:["pk","primary key"],Unique:["unique"],NotNull:["not null","nn"],Increment:["increment","auto_increment","identity"]},d={Integer:["int","integer","bigint","smallint","tinyint"],String:["varchar","char","text","string"],Date:["date","datetime","timestamp","time"],Boolean:["bool","boolean"],Float:["float","double","decimal","real"],Json:["json","jsonb"]},ke={from:"one",to:"one"},O=["created_at","createdat","creation_date"],x=["updated_at","updatedat","modification_date"],ce=["deleted_at","deletedat","deletion_date"],de=["time","timestamp","timestamptz","datetime"];function bt(i){let e={};for(let t of i){let n=t.toLowerCase().trim();Y.PrimaryKey.includes(n)&&(e.pk=!0),Y.Unique.includes(n)&&(e.unique=!0),Y.NotNull.includes(n)&&(e.nullable=!1),Y.Increment.includes(n)&&(e.increment=!0)}return e}var he=class i{dbmlContent=c("");parsedSchema=c(null);schema=b(()=>this.parsedSchema());constructor(){S(()=>{let e=this.dbmlContent();this.parsedSchema.set(this.parseDbmlToJson(e))})}setDbmlContent(e){this.dbmlContent.set(e)}parseDbmlToJson(e){if(!e.trim())return{tables:[],relations:[]};let t=e.split(`
`),n={tables:[],relations:[]},r=null;for(let o of t){if(o=o.trim(),!o||o.startsWith("//"))continue;let s=o.match(/Table\s+([\w_]+)\s*\{/);if(s){r={name:s[1],alias:null,columns:[]},n.tables.push(r);continue}if(o==="}"&&r){r=null;continue}if(r){let l=this.parseColumnLine(o);if(l&&(r.columns.push(l),l.ref)){let u=this.determineRelationCardinalityFromRef(l.ref);n.relations.push({from:{table:r.name,column:l.name},to:{table:l.ref.table,column:l.ref.column},cardinality:u})}continue}let a=o.match(/Ref(?:\s+(\w+))?\s*:?\s*([\w_]+)\.([\w_]+)\s*([<>-]+)\s*([\w_]+)\.([\w_]+)/);if(console.log("relationMatch:",a),a){let l=this.parseRelationshipLine(o);if(l&&(n.relations.push(l),l.cardinality.from==="many"&&l.cardinality.to==="many")){let u=a[1]||`${l.from.table}_${l.to.table}`;this.detectJunctionTable(n,l,u)}}}return this.addMissingForeignKeyColumns(n),this.deduplicateRelations(n)}determineRelationCardinalityFromRef(e){let t={from:"many",to:"one"};return e.cardinality||t}detectJunctionTable(e,t,n){if(t.cardinality.from!=="many"||t.cardinality.to!=="many")return;let r=e.tables.find(h=>h.name===n),o=e.tables.find(h=>h.name===t.from.table),s=e.tables.find(h=>h.name===t.to.table),a=o?.columns.find(h=>h.name===t.from.column),l=s?.columns.find(h=>h.name===t.to.column),u=`${t.from.table}_${t.from.column}`,G=`${t.to.table}_${t.to.column}`;if(r){let h=!1,ie=!1;for(let _ of r.columns)_.ref?.table===t.from.table&&_.ref?.column===t.from.column&&(h=!0,_.pk||(_.pk=!0)),_.ref?.table===t.to.table&&_.ref?.column===t.to.column&&(ie=!0,_.pk||(_.pk=!0));h||r.columns.push({name:u,type:a?.type||"int",pk:!0,ref:{table:t.from.table,column:t.from.column,cardinality:{from:"many",to:"one"}}}),ie||r.columns.push({name:G,type:l?.type||"int",pk:!0,ref:{table:t.to.table,column:t.to.column,cardinality:{from:"many",to:"one"}}})}else e.tables.push({name:n,alias:null,columns:[{name:u,type:a?.type||"int",pk:!0,ref:{table:t.from.table,column:t.from.column,cardinality:{from:"many",to:"one"}}},{name:G,type:l?.type||"int",pk:!0,ref:{table:t.to.table,column:t.to.column,cardinality:{from:"many",to:"one"}}}]})}addMissingForeignKeyColumns(e){for(let t of e.relations){if(t.cardinality.from==="many"&&t.cardinality.to==="many")continue;let n=e.tables.find(o=>o.name===t.from.table);if(!n)continue;let r=n.columns.find(o=>o.name===t.from.column);if(r)r.ref||(r.ref={table:t.to.table,column:t.to.column,cardinality:t.cardinality});else{let s=e.tables.find(a=>a.name===t.to.table)?.columns.find(a=>a.name===t.to.column);s&&n.columns.push({name:`${t.to.table}_${t.to.column}`,type:s.type,ref:{table:t.to.table,column:t.to.column,cardinality:t.cardinality}})}}}deduplicateRelations(e){let t=e.relations.filter((n,r,o)=>r===o.findIndex(s=>s.from.table===n.from.table&&s.from.column===n.from.column&&s.to.table===n.to.table&&s.to.column===n.to.column));return v(y({},e),{relations:t})}parseColumnLine(e){let t=e.match(/([\w_]+)\s+([\w\(\)]+)\s*\[([^\]]+)\]/);if(t){let[,r,o,s]=t,a={name:r,type:o},l=s.split(",").map(u=>u.trim());return Object.assign(a,bt(l)),this.parseAttributes(a,l),a}let n=e.match(/([\w_]+)\s+([\w\(\)]+)/);if(n){let[,r,o]=n;return{name:r,type:o}}return null}parseAttributes(e,t){for(let n of t)this.parseReference(n,e),this.parseDefault(n,e),this.parseNote(n,e)}parseReference(e,t){let n=e.match(/ref:\s*(<>|<|>|-)\s*([\w_]+)\.([\w_]+)/);if(!n)return;console.log(n);let[,r,o,s]=n,a={table:o,column:s};a.cardinality=Pe[r]??{from:"one",to:"one"},t.ref=a}parseDefault(e,t){let n=e.match(/default:\s*(.+)/i);if(!n)return;let r=n[1].trim(),o=!1;if((r.startsWith("'")&&r.endsWith("'")||r.startsWith('"')&&r.endsWith('"')||r.startsWith("`")&&r.endsWith("`"))&&(o=!0,r=r.slice(1,-1)),!r)return;if(o){t.default=r;return}let s=r.toLowerCase();if(s==="true"){t.default=!0;return}if(s==="false"){t.default=!1;return}let a=Number(r);if(!isNaN(a)){t.default=a;return}t.default=r}parseNote(e,t){let n=e.match(/note:\s*['"`](.+?)['"`]/);n&&(t.note=n[1])}parseRelationshipLine(e){let t=e.match(/Ref(?:\s+(\w+))?\s*:?\s*([\w_]+)\.([\w_]+)\s*([<>-]+)\s*([\w_]+)\.([\w_]+)/);if(!t)return null;let[,n,r,o,s,a,l]=t,u=ke;return u=Pe[s]??ke,{from:{table:r,column:o},to:{table:a,column:l},cardinality:u}}static \u0275fac=function(t){return new(t||i)};static \u0275prov=T({token:i,factory:i.\u0275fac,providedIn:"root"})};function Le(i){let e=i.toLowerCase();return d.Integer.some(t=>e.includes(t))?"int":d.String.some(t=>e.includes(t))?"varchar":d.Date.some(t=>e.includes(t))?e.includes("stamp")?"timestamp":e.includes("time")?"time":"date":d.Boolean.some(t=>e.includes(t))?"boolean":d.Float.some(t=>e.includes(t))?"float":e.includes("decimal")?"decimal":d.Json.some(t=>e.includes(t))?"json":"varchar"}function K(i){let e=i.toLowerCase();return d.Integer.some(t=>e.includes(t))?"number":d.String.some(t=>e.includes(t))?"string":d.Date.some(t=>e.includes(t))?"Date":d.Boolean.some(t=>e.includes(t))?"boolean":d.Float.some(t=>e.includes(t))?"number":d.Json.some(t=>e.includes(t))?"Record<string, any>":"string"}var fe=class i{generateCode(e,t={}){return{entities:this.generateEntities(e,t),module:this.generateModule(e,t)}}generateEntities(e,t={}){if(!e?.tables?.length)return{};let n={};for(let r of e.tables){let o=this.getEntityFileName(r.name),s=this.generateEntityClass(r,e);n[o]=s}return n}generateModule(e,t={}){if(!e?.tables?.length)return"";let n=e.tables.map(o=>{let s=this.getClassName(o.name),a=this.getEntityFileName(o.name).replace(".ts","");return`import { ${s} } from './${a}';`}).join(`
`),r=e.tables.map(o=>this.getClassName(o.name)).join(", ");return`import { Module } from '@nestjs/common';
import { TypeOrmModule } from '@nestjs/typeorm';
${n}

@Module({
  imports: [TypeOrmModule.forFeature([${r}])],
  exports: [TypeOrmModule],
})
export class DatabaseModule {}
`}generateEntityClass(e,t){let n=this.getClassName(e.name),r=[`import { Entity, ${this.getTypeOrmImports(e,t)} } from 'typeorm';`],o=this.getRelationImports(e,t);r.push(...o);let s=e.columns.map(u=>this.generateColumn(u,e,t)).join(`

  `),a=this.generateOneToManyRelations(e,t),l=[s,a].filter(Boolean).join(`

  `);return`${r.join(`
`)}

@Entity('${e.name}')
export class ${n} {
  ${l}
}
`}generateColumn(e,t,n){let r=Le(e.type),o=e.note?`/** ${e.note} */
  `:"",s=[];if(e.ref&&e.ref.cardinality?.from==="many"&&e.ref.cardinality?.to==="many"&&e.pk)return e.increment?s.push("@PrimaryGeneratedColumn('increment')"):s.push("@PrimaryColumn()"),`${o}${s.join(`
  `)}
  ${e.name}: ${K(e.type)};`;if(e.ref){let l=n.tables.find(De=>De.name===e.ref?.table);if(!l)return"";let u=this.getClassName(l.name),G=this.getCamelCase(u),h=this.getClassName(t.name),ie=this.getCamelCase(h),_=[];e.ref.onDelete&&_.push(`onDelete: '${e.ref.onDelete}'`),e.ref.onUpdate&&_.push(`onUpdate: '${e.ref.onUpdate}'`);let Ye=_.length?`, { ${_.join(", ")} }`:"";if(e.unique||e.ref.cardinality?.from==="one"&&e.ref.cardinality?.to==="one")s.push(`@OneToOne(() => ${u}, ${this.getCamelCase(u)} => ${this.getCamelCase(u)}.${ie}${Ye})`,`@JoinColumn({ name: '${e.name}' })`);else{let De=this.getPluralCamelCase(h);s.push(`@ManyToOne(() => ${u}, ${this.getCamelCase(u)} => ${this.getCamelCase(u)}.${De}${Ye})`,`@JoinColumn({ name: '${e.name}' })`)}return`${o}${s.join(`
  `)}
  ${G}: ${u};`}if(e.pk)return e.increment?s.push("@PrimaryGeneratedColumn('increment')"):s.push("@PrimaryColumn()"),`${o}${s.join(`
  `)}
  ${e.name}: ${K(e.type)};`;if(this.isTimestampColumn(e))return this.generateTimestampColumn(e,o);let a=[`type: '${r}'`];return e.nullable===!1&&a.push("nullable: false"),e.unique&&a.push("unique: true"),e.default!==void 0&&a.push(`default: ${JSON.stringify(e.default)}`),s.push(`@Column({ ${a.join(", ")} })`),`${o}${s.join(`
  `)}
  ${e.name}: ${K(e.type)};`}getTypeOrmImports(e,t){let n=new Set(["Column"]);for(let a of e.columns)if(a.pk&&(a.increment?n.add("PrimaryGeneratedColumn"):n.add("PrimaryColumn")),a.ref&&(a.unique?n.add("OneToOne"):n.add("ManyToOne"),n.add("JoinColumn")),this.isTimestampColumn(a)){let l=a.name.toLowerCase();O.includes(l)&&n.add("CreateDateColumn"),x.includes(l)&&n.add("UpdateDateColumn"),ce.includes(l)&&n.add("DeleteDateColumn")}let r=t.tables.flatMap(a=>a.columns.filter(l=>l.ref?.table===e.name)),o=r.some(a=>!a.unique),s=r.some(a=>a.unique);return o&&n.add("OneToMany"),s&&n.add("OneToOne"),Array.from(n).join(", ")}getRelationImports(e,t){let n=new Set;for(let r of e.columns)if(r.ref){let o=t.tables.find(s=>s.name===r.ref?.table);if(o){let s=this.getClassName(o.name),a=this.getEntityFileName(o.name).replace(".ts","");n.add(`import { ${s} } from './${a}';`)}}for(let r of t.tables){if(r.name===e.name)continue;if(r.columns.filter(s=>s.ref?.table===e.name).length>0){let s=this.getClassName(r.name),a=this.getEntityFileName(r.name).replace(".ts","");n.add(`import { ${s} } from './${a}';`)}}return Array.from(n)}generateOneToManyRelations(e,t){let n=[];for(let r of t.tables){if(r.name===e.name)continue;let o=r.columns.filter(s=>s.ref?.table===e.name);for(let s of o){let a=this.getClassName(r.name),l=this.getClassName(e.name),u=this.getCamelCase(l);if(s.unique||s.ref?.cardinality?.from==="one"&&s.ref?.cardinality?.to==="one"){let h=this.getCamelCase(a);n.push(`@OneToOne(() => ${a}, ${this.getCamelCase(a)} => ${this.getCamelCase(a)}.${u})
  ${h}: ${a};`)}else{let h=this.getPluralCamelCase(a);n.push(`@OneToMany(() => ${a}, ${this.getCamelCase(a)} => ${this.getCamelCase(a)}.${u})
  ${h}: ${a}[];`)}}}return n.join(`

  `)}isTimestampColumn(e){let t=de.includes(e.type.toLowerCase()),n=O.concat(ce,x).includes(e.name.toLowerCase());return t&&n}generateTimestampColumn(e,t){let n=e.name.toLowerCase(),r=K(e.type);return O.includes(n)?`${t}@CreateDateColumn({ type: 'timestamptz', default: () => 'CURRENT_TIMESTAMP' })
  ${e.name}: ${r};`:x.includes(n)?`${t}@UpdateDateColumn({ type: 'timestamptz', default: () => 'CURRENT_TIMESTAMP', onUpdate: 'CURRENT_TIMESTAMP' })
  ${e.name}: ${r};`:ce.includes(n)?`${t}@DeleteDateColumn({ type: 'timestamptz', nullable: true })
  ${e.name}: ${r};`:`${t}@Column({ type: '${Le(e.type)}' })
  ${e.name}: ${r};`}getClassName(e){return e.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join("")}getEntityFileName(e){return`${e}.entity.ts`}getCamelCase(e){return e.charAt(0).toLowerCase()+e.slice(1)}getPluralCamelCase(e){let t=this.getCamelCase(e);return t.endsWith("s")?t:`${t}s`}static \u0275fac=function(t){return new(t||i)};static \u0275prov=T({token:i,factory:i.\u0275fac,providedIn:"root"})};function Dt(i){let e=i.toLowerCase();return d.Integer.some(t=>e.includes(t))?"Int":d.String.some(t=>e.includes(t))?"String":d.Date.some(t=>e.includes(t))?"DateTime":d.Boolean.some(t=>e.includes(t))?"Boolean":d.Float.some(t=>e.includes(t))?"Float":d.Json.some(t=>e.includes(t))?"Json":"String"}var me=class i{generateCode(e){let t=e.tables.map(n=>this.generateModel(n,e)).join(`

`);return{schema:this.generateSchemaFile(t)}}generateSchemaFile(e){return`generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

${e}
`}generateModel(e,t){let n=this.getModelName(e.name),r=this.isJunctionTable(e,t),o="";r&&(o=`id Int @id @default(autoincrement())
  `);let s=e.columns.map(u=>this.generateField(u,e,t,r)).filter(Boolean).join(`
  `);o+=s;let a=this.generateRelations(e,t),l=[o,a].filter(Boolean).join(`

  `);return`model ${n} {
  ${l}
}`}isJunctionTable(e,t){let n=e.columns.filter(o=>o.ref);return n.length<2?!1:new Set(n.map(o=>o.ref?.table).filter(Boolean)).size>=2}generateField(e,t,n,r){let o=e.name,s=this.mapToPrismaType(e),a=this.getFieldAttributes(e,t,n,r);return`${o} ${s}${a}`}mapToPrismaType(e){let t=Dt(e.type),n=e.default!==void 0||O.includes(e.name.toLowerCase())||x.includes(e.name.toLowerCase());return e.nullable===!0&&!n?`${t}?`:t}getFieldAttributes(e,t,n,r){let o=[];return e.pk&&!r&&(e.increment?o.push("@id @default(autoincrement())"):o.push("@id")),e.unique&&!e.pk&&o.push("@unique"),e.default!==void 0&&!e.increment&&(O.concat(x).includes(e.name.toLowerCase())&&de.includes(e.type.toLowerCase())||o.push(this.formatDefault(e.default,e.type))),O.includes(e.name.toLowerCase())&&o.push("@default(now())"),x.includes(e.name.toLowerCase())&&o.push("@updatedAt"),e.name.includes("_")&&o.push(`@map("${e.name}")`),o.length>0?` ${o.join(" ")}`:""}formatDefault(e,t){return typeof e=="string"?`@default("${e}")`:typeof e=="boolean"?`@default(${e})`:typeof e=="number"?`@default(${e})`:""}generateRelations(e,t){let n=[];for(let r of e.columns){if(!r.ref)continue;let o=t.tables.find(u=>u.name===r.ref?.table);if(!o||r.ref.cardinality?.from==="many"&&r.ref.cardinality?.to==="many")continue;let s=this.camelCase(o.name),a=this.getModelName(o.name),l=r.nullable===!0?"?":"";n.push(`${s} ${a}${l} @relation(fields: [${r.name}], references: [${r.ref.column}])`)}for(let r of t.tables){if(r.name===e.name)continue;let o=r.columns.filter(s=>s.ref?.table===e.name);for(let s of o){let a=this.getModelName(r.name),l=this.camelCase(r.name);s.ref?.cardinality?.from==="many"&&s.ref?.cardinality?.to==="many"||(s.unique?n.push(`${l} ${a}?`):n.push(`${l} ${a}[]`))}}return n.join(`
  `)}getModelName(e){return e.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join("")}camelCase(e){return e.split("_").map((n,r)=>r===0?n.toLowerCase():n.charAt(0).toUpperCase()+n.slice(1).toLowerCase()).join("")}static \u0275fac=function(t){return new(t||i)};static \u0275prov=T({token:i,factory:i.\u0275fac,providedIn:"root"})};var Mt="input",Vt="output",je={id:"schema-json",filename:"schema.json"},$e={id:"schema-prisma",filename:"schema.prisma"},Ue={id:"database-module",filename:"database.module.ts"};var Q={DBML_CONTENT:"dbml_content",OUTPUT_TYPE:"output_type"};var Et=class i{dbmlParserService=H(he);nestjsGeneratorService=H(fe);prismaGeneratorService=H(me);constructor(){S(()=>{let e=this.dbmlContent();this.saveToStorage(Q.DBML_CONTENT,e)}),S(()=>{let e=this.selectedOutputType();this.saveToStorage(Q.OUTPUT_TYPE,e)})}dbmlContent=c(this.loadFromStorage(Q.DBML_CONTENT)||"");selectedOutputType=c(this.loadOutputTypeFromStorage()||F.json);isConverting=c(!1);files=c([]);selectedFile=c(null);input=c("");expandedFolders=c(new Set);schema=this.dbmlParserService.schema;nestjsCode=b(()=>{let e=this.schema();return e?this.nestjsGeneratorService.generateCode(e):null});prismaSchema=b(()=>{let e=this.schema();return e?this.prismaGeneratorService.generateCode(e).schema:null});setDbmlContent(e){this.dbmlContent.set(e)}setOutputType(e){let t=Object.values(Ct).find(n=>n.id===e);if(!t){console.warn(`Output type with id "${e}" not found`);return}this.selectedOutputType()!==e&&this.selectedOutputType.set(t.id)}handleConvert(){this.isConverting.set(!0),this.dbmlParserService.setDbmlContent(this.dbmlContent()),setTimeout(()=>{let e=this.schema();if(!e){this.isConverting.set(!1);return}let t=this.selectedOutputType(),n=[];switch(t){case F.json:n.push({id:je.id,filename:je.filename,content:vt(e)});break;case F.typeorm:let o=this.nestjsCode();o&&(Object.entries(o.entities).forEach(([a,l])=>{n.push({id:`entity-${a}`,filename:a,content:l})}),t===F.typeorm&&n.push({id:Ue.id,filename:Ue.filename,content:o.module}));break;case F.prisma:let s=this.prismaGeneratorService.generateCode(e);n.push({id:$e.id,filename:$e.filename,content:s.schema});break}this.files.set(n);let r=new Set(this.expandedFolders());r.add(Mt),r.add(Vt),this.expandedFolders.set(r),this.isConverting.set(!1)},100)}clearAll(){this.dbmlContent.set(""),this.input.set(""),this.files.set([]),this.selectedFile.set(null)}onDbmlInput(e){this.dbmlContent.set(e)}saveToStorage(e,t){try{localStorage.setItem(e,JSON.stringify(t))}catch(n){console.error("Error saving to localStorage:",n)}}loadFromStorage(e){try{let t=localStorage.getItem(e);return t?JSON.parse(t):null}catch(t){return console.error("Error loading from localStorage:",t),null}}loadOutputTypeFromStorage(){try{let e=localStorage.getItem(Q.OUTPUT_TYPE);if(!e)return null;let t=JSON.parse(e);return Object.values(F).includes(t)?t:null}catch(e){return console.error("Error loading output type from localStorage:",e),null}}static \u0275fac=function(t){return new(t||i)};static \u0275prov=T({token:i,factory:i.\u0275fac,providedIn:"root"})};var Tt=class i{transform(e){return e?e.replace(/[\n\t ]/g,"").length:0}static \u0275fac=function(t){return new(t||i)};static \u0275pipe=nt({name:"codeChars",type:i,pure:!0})};var Nt=(()=>{class i{_renderer;_elementRef;onChange=t=>{};onTouched=()=>{};constructor(t,n){this._renderer=t,this._elementRef=n}setProperty(t,n){this._renderer.setProperty(this._elementRef.nativeElement,t,n)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static \u0275fac=function(n){return new(n||i)(f(Ae),f(Te))};static \u0275dir=L({type:i})}return i})(),nn=(()=>{class i extends Nt{static \u0275fac=(()=>{let t;return function(r){return(t||(t=et(i)))(r||i)}})();static \u0275dir=L({type:i,features:[q]})}return i})(),Pt=new P("");var rn={provide:Pt,useExisting:Me(()=>Ce),multi:!0};function on(){let i=xe()?xe().getUserAgent():"";return/android (\d+)/.test(i.toLowerCase())}var sn=new P(""),Ce=(()=>{class i extends Nt{_compositionMode;_composing=!1;constructor(t,n,r){super(t,n),this._compositionMode=r,this._compositionMode==null&&(this._compositionMode=!on())}writeValue(t){let n=t??"";this.setProperty("value",n)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static \u0275fac=function(n){return new(n||i)(f(Ae),f(Te),f(sn,8))};static \u0275dir=L({type:i,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(n,r){n&1&&V("input",function(s){return r._handleInput(s.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(s){return r._compositionEnd(s.target.value)})},standalone:!1,features:[Oe([rn]),q]})}return i})();var an=new P(""),ln=new P("");function Rt(i){return i!=null}function kt(i){return rt(i)?Qe(i):i}function Lt(i){let e={};return i.forEach(t=>{e=t!=null?y(y({},e),t):e}),Object.keys(e).length===0?null:e}function jt(i,e){return e.map(t=>t(i))}function un(i){return!i.validate}function $t(i){return i.map(e=>un(e)?e:t=>e.validate(t))}function cn(i){if(!i)return null;let e=i.filter(Rt);return e.length==0?null:function(t){return Lt(jt(t,e))}}function Ut(i){return i!=null?cn($t(i)):null}function dn(i){if(!i)return null;let e=i.filter(Rt);return e.length==0?null:function(t){let n=jt(t,e).map(kt);return Xe(n).pipe(Ze(Lt))}}function Bt(i){return i!=null?dn($t(i)):null}function At(i,e){return i===null?[e]:Array.isArray(i)?[...i,e]:[i,e]}function hn(i){return i._rawValidators}function fn(i){return i._rawAsyncValidators}function Be(i){return i?Array.isArray(i)?i:[i]:[]}function ge(i,e){return Array.isArray(i)?i.includes(e):i===e}function wt(i,e){let t=Be(e);return Be(i).forEach(r=>{ge(t,r)||t.push(r)}),t}function St(i,e){return Be(e).filter(t=>!ge(i,t))}var ye=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=Ut(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Bt(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},Ge=class extends ye{name;get formDirective(){return null}get path(){return null}},ne=class extends ye{_parent=null;name=null;valueAccessor=null},He=class{_cd;constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},mn={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},hr=v(y({},mn),{"[class.ng-submitted]":"isSubmitted"}),Gt=(()=>{class i extends He{constructor(t){super(t)}static \u0275fac=function(n){return new(n||i)(f(ne,2))};static \u0275dir=L({type:i,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(n,r){n&2&&ot("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},standalone:!1,features:[q]})}return i})();var Z="VALID",pe="INVALID",$="PENDING",X="DISABLED",B=class{},_e=class extends B{value;source;constructor(e,t){super(),this.value=e,this.source=t}},ee=class extends B{pristine;source;constructor(e,t){super(),this.pristine=e,this.source=t}},te=class extends B{touched;source;constructor(e,t){super(),this.touched=e,this.source=t}},U=class extends B{status;source;constructor(e,t){super(),this.status=e,this.source=t}};function pn(i){return(ve(i)?i.validators:i)||null}function gn(i){return Array.isArray(i)?Ut(i):i||null}function yn(i,e){return(ve(e)?e.asyncValidators:i)||null}function _n(i){return Array.isArray(i)?Bt(i):i||null}function ve(i){return i!=null&&!Array.isArray(i)&&typeof i=="object"}var We=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(e,t){this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return N(this.statusReactive)}set status(e){N(()=>this.statusReactive.set(e))}_status=b(()=>this.statusReactive());statusReactive=c(void 0);get valid(){return this.status===Z}get invalid(){return this.status===pe}get pending(){return this.status==$}get disabled(){return this.status===X}get enabled(){return this.status!==X}errors;get pristine(){return N(this.pristineReactive)}set pristine(e){N(()=>this.pristineReactive.set(e))}_pristine=b(()=>this.pristineReactive());pristineReactive=c(!0);get dirty(){return!this.pristine}get touched(){return N(this.touchedReactive)}set touched(e){N(()=>this.touchedReactive.set(e))}_touched=b(()=>this.touchedReactive());touchedReactive=c(!1);get untouched(){return!this.touched}_events=new Ke;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(wt(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(wt(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(St(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(St(e,this._rawAsyncValidators))}hasValidator(e){return ge(this._rawValidators,e)}hasAsyncValidator(e){return ge(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let n=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(v(y({},e),{sourceControl:n})),t&&e.emitEvent!==!1&&this._events.next(new te(!0,n))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let n=e.sourceControl??this;this._forEachChild(r=>{r.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:n})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,n),t&&e.emitEvent!==!1&&this._events.next(new te(!1,n))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let n=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(v(y({},e),{sourceControl:n})),t&&e.emitEvent!==!1&&this._events.next(new ee(!1,n))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let n=e.sourceControl??this;this._forEachChild(r=>{r.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,n),t&&e.emitEvent!==!1&&this._events.next(new ee(!0,n))}markAsPending(e={}){this.status=$;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new U(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(v(y({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=X,this.errors=null,this._forEachChild(r=>{r.disable(v(y({},e),{onlySelf:!0}))}),this._updateValue();let n=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new _e(this.value,n)),this._events.next(new U(this.status,n)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(v(y({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Z,this._forEachChild(n=>{n.enable(v(y({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(v(y({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(n=>n(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let n=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Z||this.status===$)&&this._runAsyncValidator(n,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new _e(this.value,t)),this._events.next(new U(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(v(y({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?X:Z}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=$,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1};let n=kt(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(r=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(r,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((n,r)=>n&&n._find(r),this)}getError(e,t){let n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,n){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||n)&&this._events.next(new U(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,n)}_initObservables(){this.valueChanges=new k,this.statusChanges=new k}_calculateStatus(){return this._allControlsDisabled()?X:this.errors?pe:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus($)?$:this._anyControlsHaveStatus(pe)?pe:Z}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let n=!this._anyControlsDirty(),r=this.pristine!==n;this.pristine=n,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),r&&this._events.next(new ee(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new te(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_onDisabledChange=[];_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){ve(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=gn(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=_n(this._rawAsyncValidators)}};var Ht=new P("",{providedIn:"root",factory:()=>qe}),qe="always";function Cn(i,e){return[...e.path,i]}function vn(i,e,t=qe){Dn(i,e),e.valueAccessor.writeValue(i.value),(i.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(i.disabled),Mn(i,e),En(i,e),Vn(i,e),bn(i,e)}function Ft(i,e){i.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function bn(i,e){if(e.valueAccessor.setDisabledState){let t=n=>{e.valueAccessor.setDisabledState(n)};i.registerOnDisabledChange(t),e._registerOnDestroy(()=>{i._unregisterOnDisabledChange(t)})}}function Dn(i,e){let t=hn(i);e.validator!==null?i.setValidators(At(t,e.validator)):typeof t=="function"&&i.setValidators([t]);let n=fn(i);e.asyncValidator!==null?i.setAsyncValidators(At(n,e.asyncValidator)):typeof n=="function"&&i.setAsyncValidators([n]);let r=()=>i.updateValueAndValidity();Ft(e._rawValidators,r),Ft(e._rawAsyncValidators,r)}function Mn(i,e){e.valueAccessor.registerOnChange(t=>{i._pendingValue=t,i._pendingChange=!0,i._pendingDirty=!0,i.updateOn==="change"&&Wt(i,e)})}function Vn(i,e){e.valueAccessor.registerOnTouched(()=>{i._pendingTouched=!0,i.updateOn==="blur"&&i._pendingChange&&Wt(i,e),i.updateOn!=="submit"&&i.markAsTouched()})}function Wt(i,e){i._pendingDirty&&i.markAsDirty(),i.setValue(i._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(i._pendingValue),i._pendingChange=!1}function En(i,e){let t=(n,r)=>{e.valueAccessor.writeValue(n),r&&e.viewToModelUpdate(n)};i.registerOnChange(t),e._registerOnDestroy(()=>{i._unregisterOnChange(t)})}function Tn(i,e){if(!i.hasOwnProperty("model"))return!1;let t=i.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function An(i){return Object.getPrototypeOf(i.constructor)===nn}function wn(i,e){if(!e)return null;Array.isArray(e);let t,n,r;return e.forEach(o=>{o.constructor===Ce?t=o:An(o)?n=o:r=o}),r||n||t||null}function Ot(i,e){let t=i.indexOf(e);t>-1&&i.splice(t,1)}function xt(i){return typeof i=="object"&&i!==null&&Object.keys(i).length===2&&"value"in i&&"disabled"in i}var Sn=class extends We{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(e=null,t,n){super(pn(t),yn(n,t)),this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),ve(t)&&(t.nonNullable||t.initialValueIsDefault)&&(xt(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(n=>n(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){Ot(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){Ot(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){xt(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var Fn={provide:ne,useExisting:Me(()=>ze)},It=Promise.resolve(),ze=(()=>{class i extends ne{_changeDetectorRef;callSetDisabledState;control=new Sn;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new k;constructor(t,n,r,o,s,a){super(),this._changeDetectorRef=s,this.callSetDisabledState=a,this._parent=t,this._setValidators(n),this._setAsyncValidators(r),this.valueAccessor=wn(this,o)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){let n=t.name.previousValue;this.formDirective.removeControl({name:n,path:this._getPath(n)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),Tn(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){vn(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._checkName()}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(t){It.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){let n=t.isDisabled.currentValue,r=n!==0&&pt(n);It.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?Cn(t,this._parent):[t]}static \u0275fac=function(n){return new(n||i)(f(Ge,9),f(an,10),f(ln,10),f(Pt,10),f(mt,8),f(Ht,8))};static \u0275dir=L({type:i,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[Oe([Fn]),q,R]})}return i})();var On=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=we({type:i});static \u0275inj=Ve({})}return i})();var qt=(()=>{class i{static withConfig(t){return{ngModule:i,providers:[{provide:Ht,useValue:t.callSetDisabledState??qe}]}}static \u0275fac=function(n){return new(n||i)};static \u0275mod=we({type:i});static \u0275inj=Ve({imports:[On]})}return i})();var Nn=["editorTextarea"],Pn=["highlightWrapper"],Rn=["outputElement"],kn=["editorContainer"],Ln=(i,e)=>e.number;function jn(i,e){if(i&1&&(C(0,`
      `),m(1,"div",8),C(2),g(),C(3,`
      `)),i&2){let t=e.$implicit;p(2),le(t.number)}}var zt=class i{constructor(e){this.prism=e;S(()=>{let t=this.editorTextarea();t&&t.nativeElement.focus()}),S(()=>{let t=this.editorTextarea(),n=this.outputElement();t&&n&&this.syncHighlighting()})}code=Ne;placeholder=Ne;height="400px";codeChange=new k;editorTextarea=W("editorTextarea");highlightWrapper=W("highlightWrapper");outputElement=W("outputElement");editorContainer=W("editorContainer");highlighted=c("");scrollTop=c(0);scrollLeft=c(0);isScrolling=c(!1);codeLines=b(()=>this.highlighted().split(`
`).map((t,n)=>({number:n+1,content:t||"&nbsp;"})));ngAfterViewInit(){this.syncHighlighting()}handleScroll(e){let t=e.target;this.scrollTop.set(t.scrollTop),this.scrollLeft.set(t.scrollLeft),this.syncHighlighting()}onCodeChange(){this.highlightCode(),this.codeChange.emit(this.code),requestAnimationFrame(()=>this.syncHighlighting())}syncHighlighting(){let e=this.editorTextarea()?.nativeElement,t=this.outputElement()?.nativeElement;!e||!t||(t.style.width=e.scrollWidth+"px",t.style.height=e.scrollHeight+"px")}handleContainerScroll(e){if(this.isScrolling())return;this.isScrolling.set(!0);let t=e.target;this.scrollTop.set(t.scrollTop),this.scrollLeft.set(t.scrollLeft),requestAnimationFrame(()=>{this.isScrolling.set(!1)})}ngOnChanges(e){e.code&&this.highlightCode()}onSelectionChange(){requestAnimationFrame(()=>{let e=this.editorTextarea()?.nativeElement;e&&(this.scrollTop.set(e.scrollTop),this.scrollLeft.set(e.scrollLeft))})}onKeyDown(e){if(e.key==="Tab"){if(e.preventDefault(),e.stopPropagation(),!this.code){this.code=this.placeholder,this.onCodeChange();let s=e.target;setTimeout(()=>{s.selectionStart=s.selectionEnd=this.placeholder.length},0);return}let t=e.target,n=t.selectionStart,r=t.selectionEnd,o="	";this.code=this.code.substring(0,n)+o+this.code.substring(r),setTimeout(()=>{t.selectionStart=t.selectionEnd=n+o.length,this.onCodeChange()},0)}}highlightCode(){this.highlighted.set(this.prism.highlight(this.code))}static \u0275fac=function(t){return new(t||i)(f(ue))};static \u0275cmp=D({type:i,selectors:[["app-dbml-code-editor"]],viewQuery:function(t,n){t&1&&(J(n.editorTextarea,Nn,5),J(n.highlightWrapper,Pn,5),J(n.outputElement,Rn,5),J(n.editorContainer,kn,5)),t&2&&ct(4)},inputs:{code:"code",placeholder:"placeholder",height:"height"},outputs:{codeChange:"codeChange"},features:[R],decls:15,vars:9,consts:[["editorContainer",""],["editorTextarea",""],["outputElement",""],[1,"editor-container","editor-font","border","bg-bg-secondary","border-border-muted","rounded-sm"],["spellcheck","false","wrap","off",1,"editor-input","py-4","m-0","w-full","h-full","pl-12",3,"ngModelChange","input","keydown","scroll","mouseup","select","ngModel","placeholder"],[1,"flex","editor-output","bg-bg-secondary","py-4","m-0"],[1,"flex","flex-col","items-end","w-8","pointer-events-none","z-3"],[1,"ml-4","language-dbml",3,"innerHTML"],[1,"num-lines"]],template:function(t,n){if(t&1){let r=ae();m(0,"div",3,0)(2,"textarea",4,1),ft("ngModelChange",function(s){return A(r),ht(n.code,s)||(n.code=s),w(s)}),V("input",function(){return A(r),w(n.onCodeChange())})("keydown",function(s){return A(r),w(n.onKeyDown(s))})("scroll",function(s){return A(r),w(n.handleScroll(s))})("mouseup",function(){return A(r),w(n.onSelectionChange())})("select",function(){return A(r),w(n.onSelectionChange())}),g(),m(4,"pre",5,2),C(6,"  "),C(7,`
   `),C(8,`
    `),m(9,"div",6),C(10,`
      `),oe(11,jn,4,1,null,null,Ln),g(),C(13,`
  `),M(14,"code",7),g()()}t&2&&(z("height",n.height),p(2),dt("ngModel",n.code),I("placeholder",n.placeholder),p(2),z("top",-n.scrollTop(),"px")("left",-n.scrollLeft(),"px"),p(7),se(n.codeLines()),p(3),I("innerHTML",n.highlighted(),re))},dependencies:[qt,Ce,Gt,ze],styles:[".editor-font[_ngcontent-%COMP%]{font-family:Consolas,Monaco,Courier New,monospace;font-size:14px;line-height:1.5;tab-size:4}.editor-container[_ngcontent-%COMP%]{position:relative;min-height:200px;overflow:hidden}textarea.editor-input[_ngcontent-%COMP%]{box-sizing:border-box;color:transparent;caret-color:#fff;border:none;resize:none;overflow:auto;white-space:pre;position:absolute;top:0;left:0;z-index:2}textarea.editor-input[_ngcontent-%COMP%]:focus{outline:none}.editor-input[_ngcontent-%COMP%]::placeholder{color:#71717a}.num-lines[_ngcontent-%COMP%]{text-align:right;color:#71717a;-webkit-user-select:none;user-select:none;font-variant-numeric:tabular-nums;display:inline-block}.editor-output[_ngcontent-%COMP%]{box-sizing:border-box;white-space:pre;overflow:visible;position:absolute;top:0;left:0;z-index:1;pointer-events:none}"]})};var Yt=en(tn());var Jt=class i{constructor(e){this.prismService=e}DEFAULT_PRISM_LANGUAGE=Ie;code="";language=Ie;height="200px";charsCount=0;highlightedCode="";ngOnChanges(e){(e.code||e.language)&&this.highlight()}highlight(){if(!this.code){this.highlightedCode="";return}let e=this.language in Yt.default.languages?this.language:this.DEFAULT_PRISM_LANGUAGE;this.highlightedCode=this.prismService.highlight(this.code,e)}static \u0275fac=function(t){return new(t||i)(f(ue))};static \u0275cmp=D({type:i,selectors:[["app-code-viewer"]],inputs:{code:"code",language:"language",height:"height"},features:[R],decls:3,vars:5,consts:[[1,"w-full","overflow-auto","border","border-border-muted","rounded-sm","bg-code-box-bg","text-text"],[1,"code-block","bg-code-box"],[3,"innerHTML"]],template:function(t,n){t&1&&(m(0,"div",0)(1,"pre",1),M(2,"code",2),g()()),t&2&&(z("height",n.height),p(2),j("language-"+n.language),I("innerHTML",n.highlightedCode,re))},dependencies:[gt],styles:[".code-block[_ngcontent-%COMP%]{margin:0;padding:1rem;font-family:monospace;font-size:14px;line-height:1.5;tab-size:4;white-space:pre}"]})};var $n=["buttonRef"],Un=(i,e)=>e.id;function Bn(i,e){if(i&1){let t=ae();m(0,"button",3,0),V("click",function(r){let o=A(t).$implicit,s=Fe();return w(s.handleButtonClick(o.id,r))}),M(2,"div",4)(3,"div",5),m(4,"span",6),C(5),g()()}if(i&2){let t=e.$implicit,n=Fe();j(n.getButtonClasses(t.id)),Se("aria-pressed",n.isOptionSelected(t.id)),p(2),j(n.getExpandingCircleClasses(t.id)),p(),j(n.getIndicatorClasses(t.id)),p(2),le(t.label)}}var Kt=class i{options=Ee([]);selectedId=Ee("");optionSelected=tt();buttonRefs;isOptionSelected=e=>this.selectedId()===e;handleButtonClick(e,t){this.isOptionSelected(e)||this.optionSelected.emit(e)}getClassNames(e){return this.options().find(n=>n.id===e)?.classNames||""}getButtonClasses(e){let t=this.isOptionSelected(e),n=this.getClassNames(e);return t?"text-white shadow-lg "+n:" bg-gray-800 text-gray-300  hover:bg-gray-700"}getExpandingCircleClasses(e){let t=this.isOptionSelected(e),n=this.getClassNames(e);return t?"w-full h-full top-0 left-0 scale-150 "+n:"w-3 h-3 top-1/2 left-4 -translate-y-1/2 scale-100 "+n}getIndicatorClasses(e){let t=this.isOptionSelected(e),n=this.getClassNames(e);return t?"bg-white border border-white/50":n}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=D({type:i,selectors:[["app-expanding-circle-button"]],viewQuery:function(t,n){if(t&1&&at($n,5),t&2){let r;lt(r=ut())&&(n.buttonRefs=r)}},hostAttrs:[1,"block"],inputs:{options:[1,"options"],selectedId:[1,"selectedId"]},outputs:{optionSelected:"optionSelected"},decls:3,vars:0,consts:[["buttonRef",""],[1,"flex","space-x-2"],["type","button",1,"group","relative","px-4","py-1.5","text-sm","font-medium","rounded-lg","flex","items-center","overflow-hidden","transition-all","duration-300","ease-out",3,"class"],["type","button",1,"group","relative","px-4","py-1.5","text-sm","font-medium","rounded-lg","flex","items-center","overflow-hidden","transition-all","duration-300","ease-out",3,"click"],[1,"absolute","rounded-full","transition-all","duration-500","ease-out"],[1,"indicator","h-3","w-3","rounded-full","mr-2","relative","z-10","transition-all","duration-300"],[1,"label","relative","z-10","font-medium"]],template:function(t,n){t&1&&(m(0,"div",1),oe(1,Bn,6,8,"button",2,Un),g()),t&2&&(p(),se(n.options()))},styles:["button[_ngcontent-%COMP%]{position:relative;overflow:hidden;z-index:1;transition:all .3s ease}button[_ngcontent-%COMP%]:focus-visible{outline:2px solid rgba(66,153,225,.6);outline-offset:2px}button[_ngcontent-%COMP%]:focus:not(:focus-visible){outline:none;box-shadow:0 0 0 3px #4299e180}.indicator[_ngcontent-%COMP%]{transition:transform .2s ease-out}button[_ngcontent-%COMP%]:hover:not([aria-pressed=true])   .indicator[_ngcontent-%COMP%]{transform:scale(1.2)}@keyframes _ngcontent-%COMP%_ripple{0%{transform:translate(-50%,-50%) scale(0);opacity:.7}to{transform:translate(-50%,-50%) scale(1);opacity:0}}.ripple[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_ripple .6s cubic-bezier(.4,0,.2,1) forwards;pointer-events:none;z-index:1}"]})};function Gn(i,e){i&1&&(m(0,"span",0),C(1,"Copied!"),g())}var Qt=class i{textToCopy="";isCopied=c(!1);copyTimeout=null;copyToClipboard(e){e.stopPropagation(),navigator.clipboard.writeText(this.textToCopy).then(()=>{this.isCopied.set(!0),this.copyTimeout&&clearTimeout(this.copyTimeout),this.copyTimeout=setTimeout(()=>{this.isCopied.set(!1),this.copyTimeout=null},2e3)})}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=D({type:i,selectors:[["copy-file-button"]],hostAttrs:[1,"flex","gap-1","items-center"],inputs:{textToCopy:"textToCopy"},decls:3,vars:2,consts:[[1,"text-sm","text-accent","select-none"],[1,"inline-flex","items-center","justify-center","whitespace-nowrap","text-sm","font-medium","transition-all","outline-none","rounded-md","gap-1.5","h-6","w-6","p-0","hover:bg-hover-muted",3,"click"],["title","Copy to clipboard",3,"className"]],template:function(t,n){t&1&&(it(0,Gn,2,0,"span",0),m(1,"button",1),V("click",function(o){return n.copyToClipboard(o)}),M(2,"copy-icon",2),g()),t&2&&(st(n.isCopied()?0:-1),p(2),I("className",n.isCopied()?"w-4 h-4 text-accent":"w-4 h-4 text-text"))},dependencies:[yt],encapsulation:2})};var Zt={ts:"text/typescript",json:"application/json",sql:"application/sql",txt:"text/plain"},Je="text/plain";var Xt=class i{textToDownload="";fileName="file.txt";onDownload(e){e.stopPropagation();let t=this.getMimeType(this.fileName),n=new Blob([this.textToDownload],{type:t}),r=URL.createObjectURL(n),o=document.createElement("a");o.href=r,o.download=this.fileName,o.click(),URL.revokeObjectURL(r),o.remove()}getMimeType(e){if(!e||e.indexOf(".")===-1)return Je;let t=e.split(".").pop()?.toLowerCase();return Zt[t||""]||Je}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=D({type:i,selectors:[["download-file-button"]],hostAttrs:[1,"flex","items-center"],inputs:{textToDownload:"textToDownload",fileName:"fileName"},decls:2,vars:0,consts:[[1,"inline-flex","items-center","justify-center","whitespace-nowrap","text-sm","font-medium","transition-all","outline-none","rounded-md","gap-1.5","h-6","w-6","p-0","hover:bg-hover-muted",3,"click"],["title","Download","className","w-4 h-4 text-text"]],template:function(t,n){t&1&&(m(0,"button",0),V("click",function(o){return n.onDownload(o)}),M(1,"download-icon",1),g())},dependencies:[_t],encapsulation:2})};export{F as a,Ct as b,vt as c,Et as d,Tt as e,zt as f,Jt as g,Kt as h,Qt as i,Xt as j};
